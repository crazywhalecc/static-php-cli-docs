import{_ as s,c as o,o as a,U as e}from"./chunks/framework.a73c7ff7.js";const u=JSON.parse('{"title":"资源模块","description":"","frontmatter":{},"headers":[],"relativePath":"zh/develop/source-module.md","filePath":"zh/develop/source-module.md"}'),l={name:"zh/develop/source-module.md"},n=e(`<h1 id="资源模块" tabindex="-1">资源模块 <a class="header-anchor" href="#资源模块" aria-label="Permalink to &quot;资源模块&quot;">​</a></h1><p>static-php-cli 的下载资源模块是一个主要的功能，它包含了所依赖的库、外部扩展、PHP 源码的下载方式和资源解压方式。 下载的配置文件主要涉及 <code>source.json</code> 文件，这个文件记录了所有可下载的资源的下载方式。</p><p>下载功能主要涉及的命令有 <code>bin/spc download</code> 和 <code>bin/spc extract</code>。其中 <code>download</code> 命令是一个下载器，它会根据配置文件下载资源； <code>extract</code> 命令是一个解压器，它会根据配置文件解压资源。</p><p>一般来说，下载资源可能会比较慢，因为这些资源来源于各个官网、GitHub 等不同位置，同时它们也占用了较大空间，所以你可以在一次下载资源后，可重复使用。</p><p>下载器的配置文件是 <code>source.json</code>，它包含了所有资源的下载方式，你可以在其中添加你需要的资源下载方式，也可以修改已有的资源下载方式。</p><p>每个资源的下载配置结构如下，下面是 <code>libevent</code> 扩展对应的资源下载配置：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">libevent</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ghrel</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">repo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">libevent/libevent</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">match</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">libevent.+</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">.tar</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">.gz</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">license</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">file</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LICENSE</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>这里最主要的字段是 <code>type</code>，目前它支持的类型有：</p><ul><li><code>url</code>: 直接使用 URL 下载，例如：<code>https://download.libsodium.org/libsodium/releases/libsodium-1.0.18.tar.gz</code>。</li><li><code>ghrel</code>: 使用 GitHub Release API 下载，即从 GitHub 项目发布的最新版本中上传的附件下载。</li><li><code>ghtar</code>: 使用 GitHub Release API 下载，与 <code>ghrel</code> 不同的是，<code>ghtar</code> 是从项目的最新 Release 中找 <code>source code (tar.gz)</code> 下载的。</li><li><code>ghtagtar</code>: 使用 GitHub Release API 下载，与 <code>ghtar</code> 相比，<code>ghtagtar</code> 可以从 <code>tags</code> 列表找最新的，并下载 <code>tar.gz</code> 格式的源码（因为有些项目只使用了 <code>tag</code> 发布版本）。</li><li><code>bitbuckettag</code>: 使用 BitBucket API 下载，基本和 <code>ghtagtar</code> 相同，只是这个适用于 BitBucket。</li><li><code>git</code>: 直接从一个 Git 地址克隆项目来下载资源，适用于任何公开 Git 仓库。</li><li><code>filelist</code>: 使用爬虫爬取提供文件索引的 Web 下载站点，并获取最新版本的文件名并下载。</li><li><code>custom</code>: 如果以上下载方式都不能满足，你可以编写 <code>custom</code> 后，在 <code>src/SPC/store/source/</code> 下新建一个类，并继承 <code>CustomSourceBase</code>，自己编写下载脚本。</li></ul><p>(TODO)</p>`,10),p=[n];function t(c,r,D,d,F,i){return a(),o("div",null,p)}const C=s(l,[["render",t]]);export{u as __pageData,C as default};
